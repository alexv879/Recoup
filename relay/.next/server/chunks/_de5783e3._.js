module.exports=[78852,t=>{t.v({name:"@sendgrid/client",description:"Twilio SendGrid NodeJS API client",version:"8.1.6",author:"Twilio SendGrid <help@twilio.com> (sendgrid.com)",contributors:["Kyle Partridge <kyle.partridge@sendgrid.com>","David Tomberlin <david.tomberlin@sendgrid.com>","Swift <swift@sendgrid.com>","Brandon West <brandon.west@sendgrid.com>","Scott Motte <scott.motte@sendgrid.com>","Robert Acosta <robert.acosta@sendgrid.com>","Elmer Thomas <ethomas@twilio.com>","Adam Reis <adam@reis.nz>"],license:"MIT",homepage:"https://sendgrid.com",repository:{type:"git",url:"git://github.com/sendgrid/sendgrid-nodejs.git"},publishConfig:{access:"public"},main:"index.js",engines:{node:">=12.*"},dependencies:{"@sendgrid/helpers":"^8.0.0",axios:"^1.12.0"},devDependencies:{chai:"4.2.0",nock:"^10.0.6"},resolutions:{chai:"4.2.0"},tags:["http","rest","api","mail","sendgrid"],gitHead:"498e2329e87d804d83f4a7b519d33fa09198d0ca"})},92637,(t,e,r)=>{"use strict";e.exports=function t(e,r,s){if("object"!=typeof e||null===e)throw Error("Non object passed to convertKeys: "+e);if(Array.isArray(e))return e;for(let i in Array.isArray(s)||(s=[]),e)if(e.hasOwnProperty(i)){let o=r(i);"object"!=typeof e[i]||null===e[i]||s.includes(i)||s.includes(o)||(e[i]=t(e[i],r,s)),o!==i&&(e[o]=e[i],delete e[i])}return e}},55720,(t,e,r)=>{"use strict";e.exports=function(t){if("string"!=typeof t)throw Error("String expected for conversion to snake case");return t.trim().replace(/_+|\-+/g," ").replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(t,e){return 0===Number(t)?"":0===e?t.toLowerCase():t.toUpperCase()})}},686,(t,e,r)=>{"use strict";let s=t.r(92637),i=t.r(55720);e.exports=function(t,e){return s(t,i,e)}},46117,(t,e,r)=>{"use strict";e.exports=function(t){if("string"!=typeof t)throw Error("String expected for conversion to snake case");return t.trim().replace(/(\s*\-*\b\w|[A-Z])/g,function(t){return("_"===(t=t.trim().toLowerCase().replace("-",""))[0]?"":"_")+t}).slice(1)}},42122,(t,e,r)=>{"use strict";let s=t.r(92637),i=t.r(46117);e.exports=function(t,e){return s(t,i,e)}},71234,(t,e,r)=>{"use strict";e.exports=function(t){return JSON.parse(JSON.stringify(t))}},42452,(t,e,r)=>{"use strict";let s=t.r(686),i=t.r(42122),o=t.r(71234),n=t.r(22734),a=t.r(14747);e.exports=class{constructor(t){t&&this.fromData(t)}fromData(t){if("object"!=typeof t)throw Error("Expecting object for Mail data");let{content:e,filename:r,type:i,disposition:n,contentId:a,filePath:c}=t=s(t=o(t));if(void 0!==e&&void 0!==c)throw Error("The props 'content' and 'filePath' cannot be used together.");this.setFilename(r),this.setType(i),this.setDisposition(n),this.setContentId(a),this.setContent(c?this.readFile(c):e)}readFile(t){return n.readFileSync(a.resolve(t))}setContent(t){if("string"==typeof t){this.content=t;return}if(t instanceof Buffer&&void 0!==t.toString){this.content=t.toString(),"attachment"===this.disposition&&(this.content=t.toString("base64"));return}throw Error("`content` expected to be either Buffer or string")}setFileContent(t){if(t instanceof Buffer&&void 0!==t.toString){this.content=t.toString("base64");return}throw Error("`content` expected to be Buffer")}setFilename(t){if(void 0!==t){if(t&&"string"!=typeof t)throw Error("String expected for `filename`");this.filename=t}}setType(t){if(void 0!==t){if("string"!=typeof t)throw Error("String expected for `type`");this.type=t}}setDisposition(t){if(void 0!==t){if("string"!=typeof t)throw Error("String expected for `disposition`");this.disposition=t}}setContentId(t){if(void 0!==t){if("string"!=typeof t)throw Error("String expected for `contentId`");this.contentId=t}}toJSON(){let{content:t,filename:e,type:r,disposition:s,contentId:o}=this,n={content:t,filename:e};return void 0!==r&&(n.type=r),void 0!==s&&(n.disposition=s),void 0!==o&&(n.contentId=o),i(n)}}},14525,(t,e,r)=>{"use strict";e.exports=function(t){if(-1===t.indexOf("<"))return["",t];let[e,r]=t.split("<");return[e=e.trim(),r=r.replace(">","").trim()]}},50390,(t,e,r)=>{"use strict";let s=t.r(14525);class i{constructor(t){t&&this.fromData(t)}fromData(t){if("string"==typeof t){let[e,r]=s(t);t={name:e,email:r}}if("object"!=typeof t)throw Error("Expecting object or string for EmailAddress data");let{name:e,email:r}=t;this.setEmail(r),this.setName(e)}setName(t){if(void 0!==t){if("string"!=typeof t)throw Error("String expected for `name`");this.name=t}}setEmail(t){if(void 0===t)throw Error("Must provide `email`");if("string"!=typeof t)throw Error("String expected for `email`");this.email=t}toJSON(){let{email:t,name:e}=this,r={email:t};return""!==e&&(r.name=e),r}static create(t){return Array.isArray(t)?t.filter(t=>!!t).map(t=>this.create(t)):t instanceof i?t:new i(t)}}e.exports=i},43303,(t,e,r)=>{"use strict";var s=function(t){var e,r,s;return!!(e=t)&&"object"==typeof e&&(r=t,"[object RegExp]"!==(s=Object.prototype.toString.call(r))&&"[object Date]"!==s&&r.$$typeof!==i)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function o(t,e){return!1!==e.clone&&e.isMergeableObject(t)?h(Array.isArray(t)?[]:{},t,e):t}function n(t,e,r){return t.concat(e).map(function(t){return o(t,r)})}function a(t){return Object.keys(t).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[])}function c(t,e){try{return e in t}catch(t){return!1}}function h(t,e,r){(r=r||{}).arrayMerge=r.arrayMerge||n,r.isMergeableObject=r.isMergeableObject||s,r.cloneUnlessOtherwiseSpecified=o;var i,l,d=Array.isArray(e);return d!==Array.isArray(t)?o(e,r):d?r.arrayMerge(t,e,r):(l={},(i=r).isMergeableObject(t)&&a(t).forEach(function(e){l[e]=o(t[e],i)}),a(e).forEach(function(r){c(t,r)&&!(Object.hasOwnProperty.call(t,r)&&Object.propertyIsEnumerable.call(t,r))||(c(t,r)&&i.isMergeableObject(e[r])?l[r]=(function(t,e){if(!e.customMerge)return h;var r=e.customMerge(t);return"function"==typeof r?r:h})(r,i)(t[r],e[r],i):l[r]=o(e[r],i))}),l)}h.all=function(t,e){if(!Array.isArray(t))throw Error("first argument should be an array");return t.reduce(function(t,r){return h(t,r,e)},{})},e.exports=h},36315,(t,e,r)=>{"use strict";e.exports=function t(e,r="{{",s="}}"){if(Array.isArray(e))return e.map(e=>t(e,r,s));let i={};for(let t in e)e.hasOwnProperty(t)&&(i[r+t+s]=String(e[t]));return i}},23643,(t,e,r)=>{"use strict";let s=t.r(50390),i=t.r(686),o=t.r(42122),n=t.r(71234),a=t.r(43303),c=t.r(36315);e.exports=class{constructor(t){this.to=[],this.cc=[],this.bcc=[],this.headers={},this.customArgs={},this.substitutions={},this.substitutionWrappers=["{{","}}"],this.dynamicTemplateData={},t&&this.fromData(t)}fromData(t){if("object"!=typeof t)throw Error("Expecting object for Mail data");let{to:e,from:r,cc:s,bcc:o,subject:a,headers:c,customArgs:h,sendAt:l,substitutions:d,substitutionWrappers:p,dynamicTemplateData:u}=t=i(t=n(t),["substitutions","dynamicTemplateData","customArgs","headers"]);this.setTo(e),this.setFrom(r),this.setCc(s),this.setBcc(o),this.setSubject(a),this.setHeaders(c),this.setSubstitutions(d),this.setSubstitutionWrappers(p),this.setCustomArgs(h),this.setDynamicTemplateData(u),this.setSendAt(l)}setSubject(t){if(void 0!==t){if("string"!=typeof t)throw Error("String expected for `subject`");this.subject=t}}setSendAt(t){if(void 0!==t){if(!Number.isInteger(t))throw Error("Integer expected for `sendAt`");this.sendAt=t}}setTo(t){void 0!==t&&(Array.isArray(t)||(t=[t]),this.to=s.create(t))}setFrom(t){void 0!==t&&(this.from=s.create(t))}addTo(t){void 0!==t&&this.to.push(s.create(t))}setCc(t){void 0!==t&&(Array.isArray(t)||(t=[t]),this.cc=s.create(t))}addCc(t){void 0!==t&&this.cc.push(s.create(t))}setBcc(t){void 0!==t&&(Array.isArray(t)||(t=[t]),this.bcc=s.create(t))}addBcc(t){void 0!==t&&this.bcc.push(s.create(t))}setHeaders(t){if(void 0!==t){if("object"!=typeof t||null===t)throw Error("Object expected for `headers`");this.headers=t}}addHeader(t,e){if("string"!=typeof t)throw Error("String expected for header key");if("string"!=typeof e)throw Error("String expected for header value");this.headers[t]=e}setCustomArgs(t){if(void 0!==t){if("object"!=typeof t||null===t)throw Error("Object expected for `customArgs`");this.customArgs=t}}addCustomArg(t,e){if("string"!=typeof t)throw Error("String expected for custom arg key");if("string"!=typeof e)throw Error("String expected for custom arg value");this.customArgs[t]=e}setSubstitutions(t){if(void 0!==t){if("object"!=typeof t)throw Error("Object expected for `substitutions`");this.substitutions=t}}addSubstitution(t,e){if("string"!=typeof t)throw Error("String expected for substitution key");if("string"!=typeof e&&"number"!=typeof e)throw Error("String or Number expected for substitution value");this.substitutions[t]=e}reverseMergeSubstitutions(t){if(null!=t){if("object"!=typeof t)throw Error("Object expected for `substitutions` in reverseMergeSubstitutions");this.substitutions=Object.assign({},t,this.substitutions)}}setSubstitutionWrappers(t){if(null!=t){if(!Array.isArray(t)||2!==t.length)throw Error("Array expected with two elements for `substitutionWrappers`");this.substitutionWrappers=t}}deepMergeDynamicTemplateData(t){if(null!=t){if("object"!=typeof t)throw Error("Object expected for `dynamicTemplateData` in deepMergeDynamicTemplateData");this.dynamicTemplateData=a(t,this.dynamicTemplateData)}}setDynamicTemplateData(t){if(void 0!==t){if("object"!=typeof t)throw Error("Object expected for `dynamicTemplateData`");this.dynamicTemplateData=t}}toJSON(){let{to:t,from:e,cc:r,bcc:s,subject:i,headers:n,customArgs:a,sendAt:h,substitutions:l,substitutionWrappers:d,dynamicTemplateData:p}=this,u={to:t};if(Array.isArray(r)&&r.length>0&&(u.cc=r),Array.isArray(s)&&s.length>0&&(u.bcc=s),Object.keys(n).length>0&&(u.headers=n),l&&Object.keys(l).length>0){let[t,e]=d;u.substitutions=c(l,t,e)}return Object.keys(a).length>0&&(u.customArgs=a),p&&Object.keys(p).length>0&&(u.dynamicTemplateData=p),void 0!==i&&(u.subject=i),void 0!==h&&(u.sendAt=h),void 0!==e&&(u.from=e),o(u,["substitutions","dynamicTemplateData","customArgs","headers"])}}},26984,(t,e,r)=>{"use strict";e.exports=function(t){return t.map(t=>"object"==typeof t&&null!==t&&"function"==typeof t.toJSON?t.toJSON():t)}},98610,(t,e,r)=>{e.exports={DYNAMIC_TEMPLATE_CHAR_WARNING:`
Content with characters ', " or & may need to be escaped with three brackets
{{{ content }}}
See https://sendgrid.com/docs/for-developers/sending-email/using-handlebars/ for more information.`}},24843,(t,e,r)=>{"use strict";let s=(t,e,r,s)=>{if(void 0!==t&&void 0!==t[r]&&typeof t[r]!==s)throw Error(`${s} expected for \`${e}.${r}\``)};e.exports={validateMailSettings(t){if("object"!=typeof t)throw Error("Object expected for `mailSettings`");let{bcc:e,bypassListManagement:r,bypassSpamManagement:i,bypassBounceManagement:o,bypassUnsubscribeManagement:n,footer:a,sandboxMode:c,spamCheck:h}=t;s(e,"bcc","enable","boolean"),s(e,"bcc","email","string"),s(r,"bypassListManagement","enable","boolean"),s(i,"bypassSpamManagement","enable","boolean"),s(o,"bypassBounceManagement","enable","boolean"),s(n,"bypassUnsubscribeManagement","enable","boolean"),s(a,"footer","enable","boolean"),s(a,"footer","text","string"),s(a,"footer","html","string"),s(c,"sandboxMode","enable","boolean"),s(h,"spamCheck","enable","boolean"),s(h,"spamCheck","threshold","number"),s(h,"spamCheck","postToUrl","string")},validateTrackingSettings(t){if("object"!=typeof t)throw Error("Object expected for `trackingSettings`");let{clickTracking:e,openTracking:r,subscriptionTracking:i,ganalytics:o}=t;s(e,"clickTracking","enable","boolean"),s(e,"clickTracking","enableText","boolean"),s(r,"openTracking","enable","boolean"),s(r,"openTracking","substitutionTag","string"),s(i,"subscriptionTracking","enable","boolean"),s(i,"subscriptionTracking","text","string"),s(i,"subscriptionTracking","html","string"),s(i,"subscriptionTracking","substitutionTag","string"),s(o,"ganalytics","enable","boolean"),s(o,"ganalytics","utm_source","string"),s(o,"ganalytics","utm_medium","string"),s(o,"ganalytics","utm_term","string"),s(o,"ganalytics","utm_content","string"),s(o,"ganalytics","utm_campaign","string")}}},99836,(t,e,r)=>{"use strict";let s=t.r(50390),i=t.r(23643),o=t.r(686),n=t.r(42122),a=t.r(71234),c=t.r(26984),{DYNAMIC_TEMPLATE_CHAR_WARNING:h}=t.r(98610),{validateMailSettings:l,validateTrackingSettings:d}=t.r(24843);class p{constructor(t){this.isDynamic=!1,this.hideWarnings=!1,this.personalizations=[],this.attachments=[],this.content=[],this.categories=[],this.headers={},this.sections={},this.customArgs={},this.trackingSettings={},this.mailSettings={},this.asm={},this.substitutions=null,this.substitutionWrappers=null,this.dynamicTemplateData=null,t&&this.fromData(t)}fromData(t){if("object"!=typeof t)throw Error("Expecting object for Mail data");let{to:e,from:r,replyTo:s,cc:i,bcc:n,sendAt:c,subject:h,text:l,html:d,content:p,templateId:u,personalizations:f,attachments:y,ipPoolName:g,batchId:m,sections:b,headers:A,categories:E,category:w,customArgs:S,asm:v,mailSettings:D,trackingSettings:x,substitutions:T,substitutionWrappers:j,dynamicTemplateData:k,isMultiple:_,hideWarnings:O,replyToList:C}=t=o(t=a(t),["substitutions","dynamicTemplateData","customArgs","headers","sections"]);this.setFrom(r),this.setReplyTo(s),this.setSubject(h),this.setSendAt(c),this.setTemplateId(u),this.setBatchId(m),this.setIpPoolName(g),this.setAttachments(y),this.setContent(p),this.setSections(b),this.setHeaders(A),this.setCategories(w),this.setCategories(E),this.setCustomArgs(S),this.setAsm(v),this.setMailSettings(D),this.setTrackingSettings(x),this.setHideWarnings(O),this.setReplyToList(C),this.isDynamic?this.setDynamicTemplateData(k):(this.setSubstitutions(T),this.setSubstitutionWrappers(j)),this.addTextContent(l),this.addHtmlContent(d),f?this.setPersonalizations(f):_&&Array.isArray(e)?e.forEach(t=>this.addTo(t,i,n)):this.addTo(e,i,n)}setFrom(t){if(this._checkProperty("from",t,[this._checkUndefined])){if("string"!=typeof t&&"string"!=typeof t.email)throw Error("String or address object expected for `from`");this.from=s.create(t)}}setReplyTo(t){if(this._checkProperty("replyTo",t,[this._checkUndefined])){if("string"!=typeof t&&"string"!=typeof t.email)throw Error("String or address object expected for `replyTo`");this.replyTo=s.create(t)}}setSubject(t){this._setProperty("subject",t,"string")}setSendAt(t){this._checkProperty("sendAt",t,[this._checkUndefined,this._createCheckThatThrows(Number.isInteger,"Integer expected for `sendAt`")])&&(this.sendAt=t)}setTemplateId(t){this._setProperty("templateId",t,"string")&&0===t.indexOf("d-")&&(this.isDynamic=!0)}setBatchId(t){this._setProperty("batchId",t,"string")}setIpPoolName(t){this._setProperty("ipPoolName",t,"string")}setAsm(t){if(this._checkProperty("asm",t,[this._checkUndefined,this._createTypeCheck("object")])){if("number"!=typeof t.groupId)throw Error("Expected `asm` to include an integer in its `groupId` field");if(t.groupsToDisplay&&(!Array.isArray(t.groupsToDisplay)||!t.groupsToDisplay.every(t=>"number"==typeof t)))throw Error("Array of integers expected for `asm.groupsToDisplay`");this.asm=t}}setPersonalizations(t){if(this._doArrayCheck("personalizations",t)){if(!t.every(t=>"object"==typeof t))throw Error("Array of objects expected for `personalizations`");this.personalizations=[],t.forEach(t=>this.addPersonalization(t))}}addPersonalization(t){this.isDynamic&&t.substitutions?delete t.substitutions:!this.isDynamic&&t.dynamicTemplateData&&delete t.dynamicTemplateData,t instanceof i||(t=new i(t)),this.isDynamic?this.applyDynamicTemplateData(t):this.applySubstitutions(t),this.personalizations.push(t)}addTo(t,e,r){if(void 0===t&&void 0===e&&void 0===r)throw Error("Provide at least one of to, cc or bcc");this.addPersonalization(new i({to:t,cc:e,bcc:r}))}setSubstitutions(t){this._setProperty("substitutions",t,"object")}setSubstitutionWrappers(t){this._checkProperty("substitutionWrappers",t,[this._checkUndefined,(t,e)=>{if(!Array.isArray(e)||2!==e.length)throw Error("Array expected with two elements for `"+t+"`")}])&&(this.substitutionWrappers=t)}applySubstitutions(t){t instanceof i&&(t.reverseMergeSubstitutions(this.substitutions),t.setSubstitutionWrappers(this.substitutionWrappers))}applyDynamicTemplateData(t){t instanceof i&&t.deepMergeDynamicTemplateData(this.dynamicTemplateData)}setDynamicTemplateData(t){if(void 0!==t){if("object"!=typeof t)throw Error("Object expected for `dynamicTemplateData`");this.hideWarnings||Object.values(t).forEach(t=>{/['"&]/.test(t)&&console.warn(h)}),this.dynamicTemplateData=t}}setContent(t){if(this._doArrayCheck("content",t)){if(!t.every(t=>"object"==typeof t))throw Error("Expected each entry in `content` to be an object");if(!t.every(t=>"string"==typeof t.type))throw Error("Expected each `content` entry to contain a `type` string");if(!t.every(t=>"string"==typeof t.value))throw Error("Expected each `content` entry to contain a `value` string");this.content=t}}addContent(t){this._checkProperty("content",t,[this._createTypeCheck("object")])&&this.content.push(t)}addTextContent(t){this._checkProperty("text",t,[this._checkUndefined,this._createTypeCheck("string")])&&this.addContent({value:t,type:"text/plain"})}addHtmlContent(t){this._checkProperty("html",t,[this._checkUndefined,this._createTypeCheck("string")])&&this.addContent({value:t,type:"text/html"})}setAttachments(t){if(this._doArrayCheck("attachments",t)){if(!t.every(t=>"string"==typeof t.content))throw Error("Expected each attachment to contain a `content` string");if(!t.every(t=>"string"==typeof t.filename))throw Error("Expected each attachment to contain a `filename` string");if(!t.every(t=>!t.type||"string"==typeof t.type))throw Error("Expected the attachment's `type` field to be a string");if(!t.every(t=>!t.disposition||"string"==typeof t.disposition))throw Error("Expected the attachment's `disposition` field to be a string");this.attachments=t}}addAttachment(t){this._checkProperty("attachment",t,[this._checkUndefined,this._createTypeCheck("object")])&&this.attachments.push(t)}setCategories(t){"string"==typeof t&&(t=[t]),this._checkProperty("categories",t,[this._checkUndefined,(t,e)=>{if(!Array.isArray(e)||!e.every(t=>"string"==typeof t))throw Error("Array of strings expected for `"+t+"`")}])&&(this.categories=t)}addCategory(t){this._checkProperty("category",t,[this._createTypeCheck("string")])&&this.categories.push(t)}setHeaders(t){this._setProperty("headers",t,"object")}addHeader(t,e){this._checkProperty("key",t,[this._createTypeCheck("string")])&&this._checkProperty("value",e,[this._createTypeCheck("string")])&&(this.headers[t]=e)}setSections(t){this._setProperty("sections",t,"object")}setCustomArgs(t){this._setProperty("customArgs",t,"object")}setTrackingSettings(t){void 0!==t&&(d(t),this.trackingSettings=t)}setMailSettings(t){void 0!==t&&(l(t),this.mailSettings=t)}setHideWarnings(t){if(void 0!==t){if("boolean"!=typeof t)throw Error("Boolean expected for `hideWarnings`");this.hideWarnings=t}}toJSON(){let{from:t,replyTo:e,sendAt:r,subject:s,content:i,templateId:o,personalizations:a,attachments:h,ipPoolName:l,batchId:d,asm:p,sections:u,headers:f,categories:y,customArgs:g,mailSettings:m,trackingSettings:b,replyToList:A}=this,E={from:t,subject:s,personalizations:c(a)};return Array.isArray(h)&&h.length>0&&(E.attachments=c(h)),Array.isArray(y)&&y.length>0&&(E.categories=y.filter(t=>""!==t)),Array.isArray(i)&&i.length>0&&(E.content=c(i)),Object.keys(f).length>0&&(E.headers=f),Object.keys(m).length>0&&(E.mailSettings=m),Object.keys(b).length>0&&(E.trackingSettings=b),Object.keys(g).length>0&&(E.customArgs=g),Object.keys(u).length>0&&(E.sections=u),Object.keys(p).length>0&&(E.asm=p),void 0!==e&&(E.replyTo=e),void 0!==r&&(E.sendAt=r),void 0!==d&&(E.batchId=d),void 0!==o&&(E.templateId=o),void 0!==l&&(E.ipPoolName=l),void 0!==A&&(E.replyToList=A),n(E,["substitutions","dynamicTemplateData","customArgs","headers","sections"])}static create(t){return Array.isArray(t)?t.filter(t=>!!t).map(t=>this.create(t)):t instanceof p?t:new p(t)}_checkProperty(t,e,r){return!r.some(r=>r(t,e))}_setProperty(t,e,r){let s=this._checkProperty(t,e,[this._checkUndefined,this._createTypeCheck(r)]);return s&&(this[t]=e),s}_checkUndefined(t,e){return void 0===e}_createTypeCheck(t){return(e,r)=>{if(typeof r!==t)throw Error(t+" expected for `"+e+"`")}}_createCheckThatThrows(t,e){return(r,s)=>{if(!t(s))throw Error(e)}}_setArrayProperty(t,e){this._doArrayCheck(t,e)&&(this[t]=e)}_doArrayCheck(t,e){return this._checkProperty(t,e,[this._checkUndefined,this._createCheckThatThrows(Array.isArray,"Array expected for`"+t+"`")])}setReplyToList(t){if(this._doArrayCheck("replyToList",t)&&t.length){if(!t.every(t=>t&&"string"==typeof t.email))throw Error("Expected each replyTo to contain an `email` string");this.replyToList=t}}}e.exports=p},13959,(t,e,r)=>{"use strict";e.exports=class{constructor(t,e,r){this.statusCode=t,this.body=e,this.headers=r}toString(){return"HTTP "+this.statusCode+" "+this.body}}},6412,(t,e,r)=>{"use strict";e.exports=class extends Error{constructor(t){super();const{headers:e,status:r,statusText:s,data:i}=t;this.code=r,this.message=s,this.response={headers:e,body:i},this.stack||Error.captureStackTrace(this,this.constructor);const o=RegExp(process.cwd()+"/","gi");this.stack=this.stack.replace(o,"")}toString(){let{body:t}=this.response,e=`${this.message} (${this.code})`;return t&&Array.isArray(t.errors)&&t.errors.forEach(t=>{let r=t.message,s=t.field,i=t.help;e+=`
  ${r}
    ${s}
    ${i}`}),e}toJSON(){let{message:t,code:e,response:r}=this;return{message:t,code:e,response:r}}}},63765,(t,e,r)=>{"use strict";let s=t.r(686),i=t.r(71234),o=["day","week","month"],n=["us","ca"],a=["desc","asc"];e.exports=class{constructor(t){this.startDate=null,this.endDate=null,this.aggregatedBy=null,t&&this.fromData(t)}fromData(t){if("object"!=typeof t)throw Error("Expecting object for Statistics data");let{startDate:e,endDate:r,aggregatedBy:o}=t=s(t=i(t),["substitutions","customArgs"]);this.setStartDate(e),this.setEndDate(r),this.setAggregatedBy(o)}setStartDate(t){if(void 0===t||isNaN(new Date(t)))throw Error("Date expected for `startDate`");console.log(t),this.startDate=new Date(t).toISOString().slice(0,10)}setEndDate(t){if(void 0===t){this.endDate=new Date().toISOString().slice(0,10);return}if(isNaN(new Date(t)))throw Error("Date expected for `endDate`");this.endDate=new Date(t).toISOString().slice(0,10)}setAggregatedBy(t){if(void 0!==t)if("string"==typeof t&&o.includes(t.toLowerCase()))this.aggregatedBy=t;else throw Error("Incorrect value for `aggregatedBy`")}getGlobal(){let{startDate:t,endDate:e,aggregatedBy:r}=this;return{startDate:t,endDate:e,aggregatedBy:r}}getAdvanced(t){let e=this.getGlobal();return void 0===t||"string"==typeof t&&n.includes(t.toLowerCase())&&(e.country=t),e}getAdvancedMailboxProviders(t){let e=this.getGlobal();if(void 0===t)return e;if(Array.isArray(t)&&t.some(t=>"string"!=typeof t))throw Error("Array of strings expected for `mailboxProviders`");return e.mailBoxProviders=t,e}getAdvancedBrowsers(t){let e=this.getGlobal();if(void 0===t)return e;if(Array.isArray(t)&&t.some(t=>"string"!=typeof t))throw Error("Array of strings expected for `browsers`");return e.browsers=t,e}getCategories(t){if(void 0===t||!this._isValidArrayOfStrings(t))throw Error("Array of strings expected for `categories`");let e=this.getGlobal();return e.categories=t,e}getSubuser(t){if(void 0===t||!this._isValidArrayOfStrings(t))throw Error("Array of strings expected for `subusers`");let e=this.getGlobal();return e.subusers=t,e}getSubuserSum(t="delivered",e=a[0],r=5,s=0){if("string"!=typeof t)throw Error("string expected for `sortByMetric`");if(!a.includes(e.toLowerCase()))throw Error("desc or asc expected for `sortByDirection`");if("number"!=typeof r)throw Error("number expected for `limit`");if("number"!=typeof s)throw Error("number expected for `offset`");let i=this.getGlobal();return i.sortByMetric=t,i.sortByDirection=e,i.limit=r,i.offset=s,i}getSubuserMonthly(t="delivered",e=a[0],r=5,s=0){if("string"!=typeof t)throw Error("string expected for `sortByMetric`");if(!a.includes(e.toLowerCase()))throw Error("desc or asc expected for `sortByDirection`");if("number"!=typeof r)throw Error("number expected for `limit`");if("number"!=typeof s)throw Error("number expected for `offset`");let i=this.getGlobal();return i.sortByMetric=t,i.sortByDirection=e,i.limit=r,i.offset=s,i}_isValidArrayOfStrings(t){return!(!Array.isArray(t)||t.length<1||t.some(t=>"string"!=typeof t))}}},35565,(t,e,r)=>{"use strict";let s=t.r(42452),i=t.r(50390),o=t.r(99836),n=t.r(23643),a=t.r(13959);e.exports={Attachment:s,EmailAddress:i,Mail:o,Personalization:n,Response:a,ResponseError:t.r(6412),Statistics:t.r(63765)}},54787,(t,e,r)=>{"use strict";e.exports=function(t,e){if("object"!=typeof t||null===t)throw Error("Not an object provided for base");if("object"!=typeof e||null===e)throw Error("Not an object provided for data");let r=Object.assign({},t);for(let t in e)e.hasOwnProperty(t)&&(e[t]&&Array.isArray(e[t])?r[t]=e[t]:e[t]&&"object"==typeof e[t]?r[t]=Object.assign({},e[t]):e[t]&&(r[t]=e[t]));return r}},34979,(t,e,r)=>{"use strict";let s=t.r(26984),i=t.r(92637),o=t.r(71234),n=t.r(54787),a=t.r(14525),c=t.r(686);e.exports={arrayToJSON:s,convertKeys:i,deepClone:o,mergeData:n,splitNameEmail:a,toCamelCase:c,toSnakeCase:t.r(42122),wrapSubstitutions:t.r(36315)}},76063,(t,e,r)=>{"use strict";e.exports={classes:t.r(35565),helpers:t.r(34979)}},42841,(t,e,r)=>{"use strict";let s=t.r(81959),i=t.r(78852),{helpers:{mergeData:o},classes:{Response:n,ResponseError:a}}=t.r(76063),c={eu:"https://api.eu.sendgrid.com/",global:"https://api.sendgrid.com/"};e.exports=class{constructor(){this.auth="",this.impersonateSubuser="",this.sendgrid_region="global",this.defaultHeaders={Accept:"application/json","Content-Type":"application/json","User-Agent":"sendgrid/"+i.version+";nodejs"},this.defaultRequest={baseUrl:"https://api.sendgrid.com/",url:"",method:"GET",headers:{},maxContentLength:1/0,maxBodyLength:1/0}}setApiKey(t){this.auth="Bearer "+t,this.setDefaultRequest("baseUrl",c[this.sendgrid_region]),this.isValidApiKey(t)||console.warn('API key does not start with "SG.".')}setTwilioEmailAuth(t,e){let r=Buffer.from(t+":"+e).toString("base64");this.auth="Basic "+r,this.setDefaultRequest("baseUrl","https://email.twilio.com/"),this.isValidTwilioAuth(t,e)||console.warn("Twilio Email credentials must be non-empty strings.")}isValidApiKey(t){return this.isString(t)&&t.trim().startsWith("SG.")}isValidTwilioAuth(t,e){return this.isString(t)&&t&&this.isString(e)&&e}isString(t){return"string"==typeof t||t instanceof String}setImpersonateSubuser(t){this.impersonateSubuser=t}setDefaultHeader(t,e){return null!==t&&"object"==typeof t?Object.assign(this.defaultHeaders,t):this.defaultHeaders[t]=e,this}setDefaultRequest(t,e){return null!==t&&"object"==typeof t?Object.assign(this.defaultRequest,t):this.defaultRequest[t]=e,this}setDataResidency(t){return c.hasOwnProperty(t)?(this.sendgrid_region=t,this.setDefaultRequest("baseUrl",c[t])):console.warn('Region can only be "global" or "eu".'),this}createHeaders(t){let e=o(this.defaultHeaders,t);return void 0===e.Authorization&&this.auth&&(e.Authorization=this.auth),this.impersonateSubuser&&(e["On-Behalf-Of"]=this.impersonateSubuser),e}createRequest(t){let e={url:t.uri||t.url,baseUrl:t.baseUrl,method:t.method,data:t.body,params:t.qs,headers:t.headers};return(e=o(this.defaultRequest,e)).headers=this.createHeaders(e.headers),e.baseURL=e.baseUrl,delete e.baseUrl,e}request(t,e){t=this.createRequest(t);let r=new Promise((e,r)=>{s(t).then(t=>e([new n(t.status,t.data,t.headers),t.data])).catch(t=>t.response&&t.response.status>=400?r(new a(t.response)):r(t))});if(e&&"function"!=typeof e)throw Error("Callback passed is not a function.");return e?r.then(t=>e(null,t)).catch(t=>e(t,null)):r}}},83519,(t,e,r)=>{"use strict";e.exports=new(t.r(42841))},3690,(t,e,r)=>{"use strict";let s=t.r(83519),i=t.r(42841);e.exports=s,e.exports.Client=i},92591,(t,e,r)=>{"use strict";let{Client:s}=t.r(3690),{classes:{Mail:i}}=t.r(76063);e.exports=class{constructor(){this.setClient(new s),this.setSubstitutionWrappers("{{","}}"),this.secretRules=[]}setClient(t){return this.client=t,this}setApiKey(t){return this.client.setApiKey(t),this}setTwilioEmailAuth(t,e){this.client.setTwilioEmailAuth(t,e)}setTimeout(t){void 0!==t&&this.client.setDefaultRequest("timeout",t)}setSubstitutionWrappers(t,e){if(void 0===t||void 0===e)throw Error("Must provide both left and right side wrappers");return Array.isArray(this.substitutionWrappers)||(this.substitutionWrappers=[]),this.substitutionWrappers[0]=t,this.substitutionWrappers[1]=e,this}setSecretRules(t){t instanceof Array||(t=[t]);let e=t.map(function(t){let e=typeof t;if("string"===e)return{pattern:new RegExp(t)};if("object"===e){t instanceof RegExp?t={pattern:t}:t.hasOwnProperty("pattern")&&"string"==typeof t.pattern&&(t.pattern=new RegExp(t.pattern));try{return t.pattern.test(""),t}catch(t){}}});this.secretRules=e.filter(function(t){return t})}filterSecrets(t){if("object"==typeof t&&!t.hasOwnProperty("content"))return;let e=this;t.content.forEach(function(t){e.secretRules.forEach(function(e){if(e.hasOwnProperty("pattern")&&!e.pattern.test(t.value))return;let r=`The pattern '${e.pattern}'`;throw e.name&&(r+=`identified by '${e.name}'`),Error(r+=" was found in the Mail content!")})})}send(t,e=!1,r){if("function"==typeof e&&(r=e,e=!1),Array.isArray(t)){let s=Promise.all(t.map(t=>this.send(t,e)));return r&&s.then(t=>r(null,t)).catch(t=>r(t,null)),s}try{void 0===t.isMultiple&&(t.isMultiple=e),void 0===t.substitutionWrappers&&(t.substitutionWrappers=this.substitutionWrappers);let s=i.create(t),o=s.toJSON();this.filterSecrets(o);let n={method:"POST",url:"/v3/mail/send",headers:s.headers,body:o};return this.client.request(n,r)}catch(t){return r&&r(t,null),Promise.reject(t)}}sendMultiple(t,e){return this.send(t,!0,e)}}},36891,(t,e,r)=>{"use strict";e.exports=new(t.r(92591))},44648,(t,e,r)=>{"use strict";let s=t.r(36891),i=t.r(92591);e.exports=s,e.exports.MailService=i},98941,t=>{"use strict";var e=t.i(44648);let r=!1;async function s(t){if(!r){let t=process.env.SENDGRID_API_KEY;if(!t)throw Error("SENDGRID_API_KEY environment variable is required. Get your API key from https://app.sendgrid.com/settings/api_keys");e.default.setApiKey(t),r=!0}try{let r={to:t.to,from:t.from||{email:process.env.SENDGRID_FROM_EMAIL,name:process.env.SENDGRID_FROM_NAME||"Relay"},templateId:t.templateId,dynamicTemplateData:t.dynamicTemplateData};await e.default.send(r),console.log(`âœ… Email sent to ${t.to}`)}catch(t){throw console.error("SendGrid email error:",t),Error("Failed to send email")}}async function i(t){let e=process.env.SENDGRID_INVOICE_TEMPLATE_ID;await s({to:t.toEmail,templateId:e,dynamicTemplateData:{freelancerName:t.freelancerName,invoiceReference:t.invoiceReference,amount:t.amount.toFixed(2),currency:t.currency||"GBP",dueDate:t.dueDate?.toISOString(),description:t.description,bankDetails:t.bankDetails,stripeLink:t.stripeLink,confirmationUrl:t.confirmationUrl}})}async function o(t){let e=process.env.SENDGRID_REMINDER_DAY7_TEMPLATE_ID;await s({to:t.toEmail,templateId:e,dynamicTemplateData:{freelancerName:t.freelancerName,invoiceReference:t.invoiceReference,amount:t.amount.toFixed(2),currency:t.currency,dueDate:t.dueDate.toISOString(),daysOverdue:t.daysOverdue}})}async function n(t){let e=process.env.SENDGRID_REMINDER_DAY21_TEMPLATE_ID;await s({to:t.toEmail,templateId:e,dynamicTemplateData:{freelancerName:t.freelancerName,invoiceReference:t.invoiceReference,amount:t.amount.toFixed(2),currency:t.currency,dueDate:t.dueDate.toISOString(),daysOverdue:t.daysOverdue}})}async function a(t){let e=process.env.SENDGRID_NOTIFICATION_TEMPLATE_ID;await s({to:t.toEmail,templateId:e,dynamicTemplateData:{subject:t.subject,message:t.message,actionUrl:t.actionUrl}})}t.s(["sendInvoiceEmail",()=>i,"sendNotificationEmail",()=>a,"sendReminderDay21Email",()=>n,"sendReminderDay7Email",()=>o])}];

//# sourceMappingURL=_de5783e3._.js.map