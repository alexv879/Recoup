module.exports=[54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},15776,e=>{"use strict";var t=e.i(89171),r=e.i(15874);class n extends Error{statusCode;code;constructor(e,t,r){super(t),this.statusCode=e,this.code=r,this.name="ApiError"}}class a extends n{details;constructor(e,t){super(400,e,"VALIDATION_ERROR"),this.details=t}}class i extends n{constructor(e="Unauthorized"){super(401,e,"UNAUTHORIZED")}}class o extends n{constructor(e="Forbidden"){super(403,e,"FORBIDDEN")}}class s extends n{constructor(e="Not found"){super(404,e,"NOT_FOUND")}}class l extends n{retryAfter;constructor(e="Rate limit exceeded",t){super(429,e,"RATE_LIMIT"),this.retryAfter=t}}class d extends n{constructor(e="Internal server error"){super(500,e,"INTERNAL_ERROR")}}function u(e){if(e instanceof n){let r={error:e.code,message:e.message};return(e instanceof a&&e.details&&(r.details=e.details),e instanceof l&&e.retryAfter)?t.NextResponse.json(r,{status:e.statusCode,headers:{"Retry-After":e.retryAfter.toString()}}):t.NextResponse.json(r,{status:e.statusCode})}return e instanceof r.ZodError?t.NextResponse.json({error:"VALIDATION_ERROR",message:"Invalid request data",details:e.issues},{status:400}):(console.error("Unhandled error:",e),t.NextResponse.json({error:"INTERNAL_ERROR",message:"An unexpected error occurred"},{status:500}))}e.s(["NotFoundError",()=>s,"errors",0,{unauthorized:(e="Unauthorized")=>new i(e),forbidden:(e="Forbidden")=>new o(e),notFound:(e="Not found")=>new s(e),badRequest:e=>new a(e),internal:(e="Internal server error")=>new d(e),rateLimit:(e="Rate limit exceeded",t)=>new l(e,t)},"handleApiError",()=>u])},73153,e=>{"use strict";var t=e.i(69719);let r=t.z.object({clientName:t.z.string().min(1,"Client name is required").max(100),clientEmail:t.z.string().email("Invalid email address"),amount:t.z.number().positive("Amount must be positive"),dueDate:t.z.string().refine(e=>!isNaN(Date.parse(e)),{message:"Invalid date format"}),description:t.z.string().max(500).optional(),paymentMethods:t.z.array(t.z.enum(["bank_transfer","card"])).min(1,"At least one payment method required")}),n=t.z.object({clientName:t.z.string().min(1).max(100).optional(),clientEmail:t.z.string().email().optional(),amount:t.z.number().positive().optional(),dueDate:t.z.string().optional(),description:t.z.string().max(500).optional(),status:t.z.enum(["draft","sent","paid","overdue","in_collections","disputed","cancelled"]).optional(),paymentMethods:t.z.array(t.z.enum(["bank_transfer","card"])).optional()});t.z.object({confirmationToken:t.z.string().uuid(),amount:t.z.number().positive("Amount must be positive"),paymentMethod:t.z.enum(["bank_transfer","card"]),datePaid:t.z.string().refine(e=>!isNaN(Date.parse(e)),{message:"Invalid date format"}),clientNotes:t.z.string().max(500).optional()}),t.z.object({accountHolderName:t.z.string().min(1,"Account holder name is required").max(100),accountNumber:t.z.string().regex(/^\d{8}$/,"Account number must be 8 digits"),sortCode:t.z.string().regex(/^\d{2}-?\d{2}-?\d{2}$/,"Sort code must be in format XX-XX-XX"),bankName:t.z.string().min(1,"Bank name is required").max(100)}),t.z.object({emailNotifications:t.z.boolean(),inAppNotifications:t.z.boolean(),quietHoursStart:t.z.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Invalid time format (HH:MM)"),quietHoursEnd:t.z.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Invalid time format (HH:MM)"),notificationTypes:t.z.array(t.z.string()),onVacation:t.z.boolean(),vacationUntil:t.z.string().optional()}),t.z.object({name:t.z.string().min(1).max(100).optional(),businessName:t.z.string().max(100).optional(),businessType:t.z.enum(["freelancer","agency","consultant"]).optional(),timezone:t.z.string().optional(),language:t.z.enum(["en","es","fr"]).optional()}),t.z.object({referralCode:t.z.string().length(8,"Invalid referral code")}),t.z.object({type:t.z.string(),data:t.z.object({object:t.z.any()})}),t.z.object({type:t.z.string(),data:t.z.any()});let a=t.z.object({limit:t.z.string().optional().transform(e=>e?parseInt(e,10):10).refine(e=>e>0&&e<=100,{message:"Limit must be between 1 and 100"}),offset:t.z.string().optional().transform(e=>e?parseInt(e,10):0).refine(e=>e>=0,{message:"Offset must be non-negative"})}).extend({status:t.z.enum(["draft","sent","paid","overdue","in_collections","disputed","cancelled"]).optional()});e.s(["InvoiceCreateSchema",0,r,"InvoiceListQuerySchema",0,a,"InvoiceUpdateSchema",0,n])},41353,e=>e.a(async(t,r)=>{try{var n=e.i(89171),a=e.i(7218),i=e.i(65839),o=e.i(73153),s=e.i(15776),l=e.i(963),d=e.i(69907),u=t([i]);async function c(e){let t=Date.now(),r="POST",u="/api/invoices";try{let{userId:c}=await (0,a.auth)();if(!c)throw s.errors.unauthorized();(0,d.logApiRequest)(r,u,c);let{success:p}=await (0,l.checkRateLimit)(c,l.ratelimit);if(!p)throw s.errors.rateLimit();let m=await e.json(),h=o.InvoiceCreateSchema.parse(m),f=await (0,i.createInvoice)({freelancerId:c,clientName:h.clientName,clientEmail:h.clientEmail,amount:h.amount,dueDate:new Date(h.dueDate),description:h.description,paymentMethods:h.paymentMethods}),R=Date.now()-t;return(0,d.logApiResponse)(r,u,201,R,c),n.NextResponse.json({invoiceId:f.invoiceId,reference:f.reference,invoice:f},{status:201})}catch(e){return(0,s.handleApiError)(e)}}async function p(e){let t=Date.now(),r="/api/invoices";try{let{userId:u}=await (0,a.auth)();if(!u)throw s.errors.unauthorized();(0,d.logApiRequest)("GET",r,u);let{success:c}=await (0,l.checkRateLimit)(u,l.ratelimit);if(!c)throw s.errors.rateLimit();let{searchParams:p}=new URL(e.url),m={status:p.get("status")||void 0,limit:p.get("limit")||void 0,offset:p.get("offset")||void 0},h=o.InvoiceListQuerySchema.parse(m),f=await (0,i.listInvoices)({userId:u,status:h.status,limit:h.limit,offset:h.offset}),R=Date.now()-t;return(0,d.logApiResponse)("GET",r,200,R,u),n.NextResponse.json(f)}catch(e){return(0,s.handleApiError)(e)}}[i]=u.then?(await u)():u,e.s(["GET",()=>p,"POST",()=>c,"dynamic",0,"force-dynamic"]),r()}catch(e){r(e)}},!1),75275,e=>e.a(async(t,r)=>{try{var n=e.i(47909),a=e.i(74017),i=e.i(96250),o=e.i(84243),s=e.i(61916),l=e.i(14444),d=e.i(37092),u=e.i(69741),c=e.i(16795),p=e.i(87718),m=e.i(95169),h=e.i(47587),f=e.i(66012),R=e.i(70101),g=e.i(26937),v=e.i(10372),E=e.i(93695);e.i(52474);var x=e.i(220),z=e.i(41353),w=t([z]);[z]=w.then?(await w)():w;let A=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/invoices/route",pathname:"/api/invoices",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/invoices/route.ts",nextConfigOutput:"",userland:z}),{workAsyncStorage:N,workUnitAsyncStorage:I,serverHooks:C}=A;function y(){return(0,i.patchFetch)({workAsyncStorage:N,workUnitAsyncStorage:I})}async function b(e,t,r){A.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/invoices/route";n=n.replace(/\/index$/,"")||"/";let i=await A.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:z,params:w,nextConfig:y,parsedUrl:b,isDraftMode:N,prerenderManifest:I,routerServerContext:C,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,resolvedPathname:O,clientReferenceManifest:D,serverActionsManifest:S}=i,j=(0,u.normalizeAppPath)(n),P=!!(I.dynamicRoutes[j]||I.routes[O]),M=async()=>((null==C?void 0:C.render404)?await C.render404(e,t,b,!1):t.end("This page could not be found"),null);if(P&&!N){let e=!!I.routes[O],t=I.dynamicRoutes[j];if(t&&!1===t.fallback&&!e){if(y.experimental.adapterPath)return await M();throw new E.NoFallbackError}}let q=null;!P||A.isDev||N||(q=O,q="/index"===q?"/":q);let H=!0===A.isDev||!P,U=P&&!H;S&&D&&(0,l.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:D,serverActionsManifest:S,serverModuleMap:(0,d.createServerModuleMap)({serverActionsManifest:S})});let k=e.method||"GET",L=(0,s.getTracer)(),F=L.getActiveScopeSpan(),$={params:w,prerenderManifest:I,renderOpts:{experimental:{authInterrupts:!!y.experimental.authInterrupts},cacheComponents:!!y.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:y.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>A.onRequestError(e,t,n,C)},sharedContext:{buildId:z}},X=new c.NodeNextRequest(e),K=new c.NodeNextResponse(t),B=p.NextRequestAdapter.fromNodeNextRequest(X,(0,p.signalFromNodeResponse)(t));try{let i=async e=>A.handle(B,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${k} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${k} ${n}`)}),l=!!(0,o.getRequestMeta)(e,"minimalMode"),d=async o=>{var s,d;let u=async({previousCacheEntry:a})=>{try{if(!l&&T&&_&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(o);e.fetchMetrics=$.renderOpts.fetchMetrics;let s=$.renderOpts.pendingWaitUntil;s&&r.waitUntil&&(r.waitUntil(s),s=void 0);let d=$.renderOpts.collectedTags;if(!P)return await (0,f.sendResponse)(X,K,n,$.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,R.toNodeOutgoingHttpHeaders)(n.headers);d&&(t[v.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=v.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,a=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=v.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await A.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:T})},C),t}},c=await A.handleResponse({req:e,nextConfig:y,cacheKey:q,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:I,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:l});if(!P)return null;if((null==c||null==(s=c.value)?void 0:s.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(d=c.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",T?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),N&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,R.fromNodeOutgoingHttpHeaders)(c.value.headers);return l&&P||p.delete(v.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,f.sendResponse)(X,K,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};F?await d(F):await L.withPropagatedContext(e.headers,()=>L.trace(m.BaseServerSpan.handleRequest,{spanName:`${k} ${n}`,kind:s.SpanKind.SERVER,attributes:{"http.method":k,"http.target":e.url}},d))}catch(t){if(t instanceof E.NoFallbackError||await A.onRequestError(e,t,{routerKind:"App Router",routePath:j,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:T})}),P)throw t;return await (0,f.sendResponse)(X,K,new Response(null,{status:500})),null}}e.s(["handler",()=>b,"patchFetch",()=>y,"routeModule",()=>A,"serverHooks",()=>C,"workAsyncStorage",()=>N,"workUnitAsyncStorage",()=>I]),r()}catch(e){r(e)}},!1),29652,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__c3778b6d._.js"].map(t=>e.l(t))).then(()=>t(26445)))},6878,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_next_92aaecbe._.js"].map(t=>e.l(t))).then(()=>t(93458)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ce14f070._.js.map