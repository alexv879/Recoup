module.exports=[505659,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(256711);function f(){let a=(0,d.useParams)(),f=(0,d.useRouter)(),g=a.id,[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("");async function v(a){a.preventDefault(),k(!0),q(null);try{let a=await fetch(`/api/invoices/${g}/verify-payment-claim`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({verified:!0,actualAmount:parseFloat(r),verificationNotes:t||void 0})}),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to verify payment");f.push("/dashboard/invoices?verified=true")}catch(a){q(a instanceof Error?a.message:"Failed to verify payment"),k(!1)}}async function w(){if(confirm("Are you sure you want to reject this payment claim? The client will be notified.")){k(!0),q(null);try{let a=prompt("Why are you rejecting this claim? (This will be sent to the client)");if(!a)return void k(!1);let b=await fetch(`/api/invoices/${g}/verify-payment-claim`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({verified:!1,verificationNotes:a})}),c=await b.json();if(!b.ok)throw Error(c.error||"Failed to reject payment claim");f.push("/dashboard/invoices?rejected=true")}catch(a){q(a instanceof Error?a.message:"Failed to reject payment claim"),k(!1)}}}return((0,c.useEffect)(()=>{async function a(){try{let a=await fetch(`/api/invoices/${g}`),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to load invoice");if(o(b),!b.paymentClaimId)throw Error("No payment claim found for this invoice");let c=await fetch(`/api/payment-claims/${b.paymentClaimId}`),d=await c.json();if(!c.ok)throw Error(d.error||"Failed to load payment claim");m(d),s(d.amount.toString())}catch(a){q(a instanceof Error?a.message:"Failed to load data")}finally{i(!1)}}g&&a()},[g]),h)?(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-b-2 border-blue-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading payment claim..."})]})}):p&&!l?(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:(0,b.jsx)("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-8",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("svg",{className:"mx-auto h-12 w-12 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,b.jsx)("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Error"}),(0,b.jsx)("p",{className:"mt-2 text-gray-600",children:p}),(0,b.jsx)("button",{onClick:()=>f.push("/dashboard/invoices"),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Back to Dashboard"})]})})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,b.jsxs)("div",{className:"text-center mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Verify Payment Claim"}),(0,b.jsx)("p",{className:"mt-2 text-gray-600",children:"Check your bank account and confirm if you received this payment"})]}),(0,b.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-8 mb-6",children:[(0,b.jsxs)("div",{className:"border-b pb-6 mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Payment Claim Details"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Invoice #",n?.reference]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Client:"}),(0,b.jsx)("span",{className:"font-medium",children:l?.clientName})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Amount Claimed:"}),(0,b.jsxs)("span",{className:"font-medium text-lg",children:[n?.currency==="GBP"?"£":"",l?.amount.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Payment Method:"}),(0,b.jsxs)("span",{className:"font-medium",children:[l?.paymentMethod==="bank_transfer"&&"Bank Transfer (BACS)",l?.paymentMethod==="cash"&&"Cash",l?.paymentMethod==="cheque"&&"Cheque"]})]}),l?.paymentReference&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Reference:"}),(0,b.jsx)("span",{className:"font-medium",children:l.paymentReference})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Date Paid (claimed):"}),(0,b.jsx)("span",{className:"font-medium",children:l?.paymentDate&&(0,e.format)(new Date(1e3*l.paymentDate.seconds),"PPP")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Claim Submitted:"}),(0,b.jsx)("span",{className:"font-medium",children:l?.createdAt&&(0,e.format)(new Date(1e3*l.createdAt.seconds),"PPP")})]}),l?.clientNotes&&(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("span",{className:"text-gray-600 block mb-2",children:"Client Notes:"}),(0,b.jsx)("p",{className:"text-gray-900 bg-gray-50 p-3 rounded",children:l.clientNotes})]})]})]}),(0,b.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("svg",{className:"h-6 w-6 text-blue-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"Check Your Bank Account"}),(0,b.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,b.jsx)("li",{children:"✓ Log into your bank account"}),(0,b.jsx)("li",{children:"✓ Check recent transactions around the claimed payment date"}),(0,b.jsxs)("li",{children:["✓ Look for the amount: £",l?.amount.toFixed(2)]}),l?.paymentReference&&(0,b.jsxs)("li",{children:["✓ Match the reference: ",l.paymentReference]}),(0,b.jsx)("li",{children:"✓ Confirm the amount received matches (or adjust below)"})]})]})]})}),(0,b.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-8",children:[p&&(0,b.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:p}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"actualAmount",className:"block text-sm font-medium text-gray-700",children:"Amount Actually Received (£)"}),(0,b.jsx)("input",{type:"number",id:"actualAmount",step:"0.01",min:"0",required:!0,value:r,onChange:a=>s(a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Adjust this if the amount received differs from the claimed amount"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"verificationNotes",className:"block text-sm font-medium text-gray-700",children:"Verification Notes (Optional)"}),(0,b.jsx)("textarea",{id:"verificationNotes",rows:3,value:t,onChange:a=>u(a.target.value),placeholder:"Any notes about this payment...",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{className:"flex space-x-4",children:[(0,b.jsxs)("button",{type:"button",onClick:w,disabled:j,className:"flex-1 flex justify-center items-center py-3 px-4 border-2 border-red-600 rounded-md shadow-sm text-sm font-medium text-red-600 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Reject Claim"]}),(0,b.jsxs)("button",{type:"submit",disabled:j,className:"flex-1 flex justify-center items-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:bg-gray-400 disabled:cursor-not-allowed",children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),j?"Verifying...":"Verify Payment"]})]})]})]})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_dashboard_invoices_%5Bid%5D_verify-payment_page_tsx_fb679a24._.js.map