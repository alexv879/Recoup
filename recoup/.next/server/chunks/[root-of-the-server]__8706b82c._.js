module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},155742,e=>e.a(async(t,r)=>{try{let t=await e.y("firebase-admin/firestore");e.n(t),r()}catch(e){r(e)}},!0),456300,e=>e.a(async(t,r)=>{try{let t=await e.y("firebase-admin/app");e.n(t),r()}catch(e){r(e)}},!0),894222,e=>e.a(async(t,r)=>{try{let t=await e.y("firebase-admin/storage");e.n(t),r()}catch(e){r(e)}},!0),868253,e=>e.a(async(t,r)=>{try{var n=e.i(456300),a=e.i(155742),o=e.i(894222),i=t([n,a,o]);if([n,a,o]=i.then?(await i)():i,!(0,n.getApps)().length)try{let e=process.env.FIREBASE_PROJECT_ID,t=process.env.FIREBASE_CLIENT_EMAIL,r=process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g,"\n");e&&t&&r?((0,n.initializeApp)({credential:(0,n.cert)({projectId:e,clientEmail:t,privateKey:r})}),console.log("✅ Firebase Admin initialized successfully")):console.warn("⚠️  Firebase credentials not configured - app will not function at runtime")}catch(e){console.error("❌ Firebase Admin initialization error:",e)}let s=null,l=new Proxy({},{get:(e,t)=>(function(){if(!s){if(!(0,n.getApps)().length)throw Error("Firebase is not initialized. Make sure environment variables are configured.");s=(0,a.getFirestore)()}return s})()[t]}),d=(0,o.getStorage)();e.s(["COLLECTIONS",0,{USERS:"users",INVOICES:"invoices",PAYMENT_CONFIRMATIONS:"payment_confirmations",PAYMENT_CLAIMS:"payment_claims",COLLECTION_ATTEMPTS:"collection_attempts",CLIENTS:"clients",NOTIFICATIONS:"notifications",TRANSACTIONS:"transactions",REFERRALS:"referrals",REFERRAL_CREDITS:"referral_credits",REFERRAL_PAYOUTS:"referral_payouts",USER_BEHAVIOR_PROFILE:"user_behavior_profile",USER_STATS:"user_stats",USER_EVENTS:"user_events",DAILY_SUMMARIES:"daily_summaries",EMAILS_SENT:"emails_sent",ONBOARDING_PROGRESS:"onboarding_progress",AGENCY_HANDOFFS:"agency_handoffs"},"db",0,l,"firestore",0,l,"storage",0,d]),r()}catch(e){r(e)}},!1),169907,e=>{"use strict";let t={info:(e,t)=>{t?console.log(`[INFO] ${t}`,e):console.log("[INFO]",e)},error:(e,t)=>{t?console.error(`[ERROR] ${t}`,e):console.error("[ERROR]",e)},warn:(e,t)=>{t?console.warn(`[WARN] ${t}`,e):console.warn("[WARN]",e)}};e.s(["logApiRequest",0,(e,r,n)=>{t.info({method:e,url:r,...n},"API Request")},"logApiResponse",0,(e,r,n,a)=>{t.info({method:e,url:r,status:n,...a},"API Response")},"logDbOperation",0,(e,r,n)=>{t.info({operation:e,collection:r,...n},"Database Operation")},"logError",0,(e,r)=>{t.error(r,e)},"logInfo",0,(e,r)=>{t.info(r,e)},"logWarn",0,(e,r)=>{t.warn(r,e)},"logger",0,t])},15776,e=>{"use strict";var t=e.i(169907),r=e.i(915874);class n extends Error{code;statusCode;constructor(e,t,r=500){super(t),this.code=e,this.statusCode=r,this.name="CustomError"}}class a extends n{constructor(e){super("VALIDATION_ERROR",e,400)}}class o extends n{constructor(e="Unauthorized"){super("UNAUTHORIZED",e,401)}}class i extends n{constructor(e="Forbidden"){super("FORBIDDEN",e,403)}}class s extends n{constructor(e="Not found"){super("NOT_FOUND",e,404)}}class l extends n{constructor(e="Bad request"){super("BAD_REQUEST",e,400)}}class d extends n{constructor(e="Rate limit exceeded"){super("RATE_LIMIT",e,429)}}async function c(e){return e instanceof r.ZodError?{status:400,body:{error:"VALIDATION_ERROR",message:"The request body is invalid.",fields:e.errors.reduce((e,t)=>(e[t.path.join(".")]=t.message,e),{})}}:e instanceof n?{status:e.statusCode,body:{error:e.code,message:e.message}}:(t.logger.error({err:e},"An unknown error occurred in handleError"),{status:500,body:{error:"INTERNAL_ERROR",message:"An unexpected error occurred"}})}e.s(["BadRequestError",()=>l,"ForbiddenError",()=>i,"NotFoundError",()=>s,"RateLimitError",()=>d,"UnauthorizedError",()=>o,"ValidationError",()=>a,"errors",0,{VALIDATION_ERROR:"VALIDATION_ERROR",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",NOT_FOUND:"NOT_FOUND",INTERNAL_ERROR:"INTERNAL_ERROR"},"handleApiError",0,c,"handleError",()=>c])},725639,e=>{"use strict";function t(e){return"paid"===e?"pro":e}let r={free:1,starter:10,growth:25,pro:Number.MAX_SAFE_INTEGER,paid:25};e.s(["ACHIEVEMENTS",0,{FIRST_INVOICE:{id:"first_invoice",name:"First Invoice",description:"Created your first invoice",threshold:500},COLLECTOR_5K:{id:"collector_5k",name:"Collector 5K",description:"Collected £5,000",threshold:5e3},COLLECTOR_50K:{id:"collector_50k",name:"Collector 50K",description:"Collected £50,000",threshold:5e4},RELIABLE:{id:"reliable",name:"Reliable",description:"90% on-time payments",threshold:90},WEEK_STREAK:{id:"week_streak",name:"Week Streak",description:"7 days without overdue",threshold:7},MONTH_STREAK:{id:"month_streak",name:"Month Streak",description:"30 days without overdue",threshold:30},TOP_100:{id:"top_100",name:"Top 100",description:"Ranked in top 100 users",threshold:100}},"APP_DESCRIPTION",0,"Smart invoicing and payment tracking for freelancers","APP_NAME",0,"Recoup","BUSINESS_TYPES",0,{FREELANCER:"freelancer",AGENCY:"agency",CONSULTANT:"consultant"},"COLLECTIONS_DEMO_LIMIT_FREE",0,1,"COLLECTIONS_LIMITS",0,r,"COLLECTION_DAY_15_REMINDER",0,15,"COLLECTION_DAY_30_REMINDER",0,30,"COLLECTION_DAY_45_AGENCY_HANDOFF",0,45,"COLLECTION_DAY_5_REMINDER",0,5,"DEFAULT_CURRENCY",0,"GBP","DEFAULT_LANGUAGE",0,"en","DEFAULT_QUIET_HOURS",0,{start:"21:00",end:"08:00"},"DEFAULT_TIMEZONE",0,"Europe/London","EMAIL_TEMPLATES",0,{INVOICE:"invoice",REMINDER_DAY_7:"reminder_day_7",REMINDER_DAY_21:"reminder_day_21",PAYMENT_CONFIRMED:"payment_confirmed",NOTIFICATION:"notification"},"FOUNDING_MEMBER_LIMIT",0,50,"FOUNDING_MEMBER_PRICING",0,{starter:9.5,growth:19.5,pro:37.5},"INVOICE_STATUS",0,{DRAFT:"draft",SENT:"sent",PAID:"paid",OVERDUE:"overdue",IN_COLLECTIONS:"in_collections",DISPUTED:"disputed",CANCELLED:"cancelled"},"MAX_NOTIFICATIONS_PER_DAY",0,3,"NOTIFICATION_CONFIDENCE_THRESHOLD",0,.6,"NOTIFICATION_EXPIRY_DAYS",0,30,"NOTIFICATION_TYPES",0,{INVOICE_DROUGHT:"invoice_drought",PAYMENT_DELAY:"payment_delay",WIN:"win",PREDICTION:"prediction",OPPORTUNITY:"opportunity",DAILY_DIGEST:"daily_digest"},"PAYMENT_CONFIRMATION_STATUS",0,{PENDING_CLIENT:"pending_client",CLIENT_CONFIRMED:"client_confirmed",BOTH_CONFIRMED:"both_confirmed",EXPIRED:"expired",CANCELLED:"cancelled"},"PAYMENT_CONFIRMATION_TOKEN_EXPIRY_DAYS",0,30,"PAYMENT_METHODS",0,{BANK_TRANSFER:"bank_transfer",CARD:"card"},"POINTS_PER_1000_COLLECTED",0,1,"POINTS_PER_BADGE",0,10,"POINTS_PER_LEVEL",0,100,"POINTS_PER_STREAK_DAY",0,1,"RATE_LIMIT",0,{GENERAL:{requests:10,window:"10s"},AUTH:{requests:5,window:"60s"},AI:{requests:3,window:"60s"}},"RECOUP_COMMISSION_RATE",0,.03,"REFERRAL_CREDIT_REFERRED",0,5,"REFERRAL_CREDIT_REFERRER",0,5,"STANDARD_PRICING",0,{starter:19,growth:39,pro:75},"SUBSCRIPTION_TIERS",0,{FREE:"free",PAID:"paid",STARTER:"starter",GROWTH:"growth",PRO:"pro"},"SUPPORTED_CURRENCIES",0,["GBP","USD","EUR"],"SUPPORTED_LANGUAGES",0,["en","es","fr"],"TIER_LEVELS",0,{free:0,starter:1,growth:2,pro:3,paid:2},"USER_STATUS",0,{ACTIVE:"active",SUSPENDED:"suspended",DELETED:"deleted"},"VALIDATION",0,{MAX_INVOICE_DESCRIPTION_LENGTH:500,MAX_CLIENT_NAME_LENGTH:100,MAX_BUSINESS_NAME_LENGTH:100,MAX_NOTE_LENGTH:1e3,MIN_INVOICE_AMOUNT:.01,MAX_INVOICE_AMOUNT:1e6,UK_ACCOUNT_NUMBER_LENGTH:8,UK_SORT_CODE_LENGTH:6},"normalizeTier",()=>t])},901750,e=>e.a(async(t,r)=>{try{var n=e.i(868253),a=e.i(155742),o=e.i(725639),i=e.i(169907),s=t([n,a]);async function l(){try{let e=(await n.db.collection("users").where("isFoundingMember","==",!0).count().get()).data().count,t=Math.max(0,o.FOUNDING_MEMBER_LIMIT-e),r=e/o.FOUNDING_MEMBER_LIMIT*100;return(0,i.logInfo)("Founding member status checked",{total:e,remaining:t,percentageFilled:r}),{totalFoundingMembers:e,spotsRemaining:t,isAvailable:t>0,percentageFilled:r}}catch(e){throw(0,i.logError)("Error getting founding member status",e),e}}async function d(e,t){try{return(0,i.logInfo)("Attempting to register founding member",{userId:e,tier:t}),await n.db.runTransaction(async r=>{let s=n.db.collection("users").doc(e),l=await r.get(s);if(!l.exists)throw Error("User not found");let d=l.data();if(d.isFoundingMember)return(0,i.logInfo)("User is already a founding member",{userId:e,memberNumber:d.foundingMemberNumber}),{success:!0,memberNumber:d.foundingMemberNumber,lockedInPrice:d.lockedInPrice,alreadyMember:!0};let c=(await r.get(n.db.collection("users").where("isFoundingMember","==",!0))).size;if(c>=o.FOUNDING_MEMBER_LIMIT)throw(0,i.logWarn)("Founding member limit reached",{currentCount:c,limit:o.FOUNDING_MEMBER_LIMIT,userId:e}),Error("All founding member spots have been claimed");let E=c+1,u=o.FOUNDING_MEMBER_PRICING[t];return r.update(s,{isFoundingMember:!0,foundingMemberNumber:E,foundingMemberJoinedAt:a.FieldValue.serverTimestamp(),lockedInPrice:u,updatedAt:a.FieldValue.serverTimestamp()}),(0,i.logInfo)("Founding member registered successfully",{userId:e,memberNumber:E,tier:t,lockedInPrice:u}),{success:!0,memberNumber:E,lockedInPrice:u}})}catch(r){return(0,i.logError)("Error registering founding member",r,{userId:e,tier:t}),{success:!1,reason:r instanceof Error?r.message:"Unknown error occurred"}}}async function c(e){try{let t=await n.db.collection("users").doc(e).get();if(!t.exists)return{isEligible:!1,reason:"User not found"};if(t.data().isFoundingMember)return{isEligible:!0};if(!(await l()).isAvailable)return{isEligible:!1,reason:"All founding member spots have been claimed"};return{isEligible:!0}}catch(t){return(0,i.logError)("Error validating founding eligibility",t,{userId:e}),{isEligible:!1,reason:"Error validating eligibility"}}}[n,a]=s.then?(await s)():s,e.s(["getFoundingMemberStatus",()=>l,"registerAsFoundingMember",()=>d,"validateFoundingEligibility",()=>c]),r()}catch(e){r(e)}},!1),155958,e=>e.a(async(t,r)=>{try{var n=e.i(89171),a=e.i(901750),o=e.i(15776),i=e.i(169907),s=t([a]);async function l(){let e=Date.now();try{(0,i.logApiRequest)("GET","/api/founding-members/status","anonymous");let t=await (0,a.getFoundingMemberStatus)(),r={spotsRemaining:t.spotsRemaining,totalFoundingMembers:t.totalFoundingMembers,isAvailable:t.isAvailable,percentageFilled:Math.round(t.percentageFilled),urgencyLevel:0===t.spotsRemaining?"sold_out":t.spotsRemaining<=5?"critical":t.spotsRemaining<=10?"high":"normal"};return(0,i.logApiResponse)("GET","/api/founding-members/status",200,Date.now()-e),n.NextResponse.json(r,{headers:{"Cache-Control":"public, s-maxage=30"}})}catch(r){let{status:e,body:t}=await (0,o.handleApiError)(r);return n.NextResponse.json(t,{status:e})}}[a]=s.then?(await s)():s,e.s(["GET",()=>l,"dynamic",0,"force-dynamic"]),r()}catch(e){r(e)}},!1),661220,e=>e.a(async(t,r)=>{try{var n=e.i(747909),a=e.i(174017),o=e.i(996250),i=e.i(759756),s=e.i(561916),l=e.i(114444),d=e.i(837092),c=e.i(869741),E=e.i(316795),u=e.i(487718),R=e.i(995169),p=e.i(47587),_=e.i(666012),I=e.i(570101),N=e.i(626937),A=e.i(10372),T=e.i(193695);e.i(52474);var g=e.i(600220),m=e.i(155958),O=t([m]);[m]=O.then?(await O)():O;let f=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/founding-members/status/route",pathname:"/api/founding-members/status",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/founding-members/status/route.ts",nextConfigOutput:"",userland:m}),{workAsyncStorage:S,workUnitAsyncStorage:b,serverHooks:D}=f;function h(){return(0,o.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:b})}async function C(e,t,r){f.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/founding-members/status/route";n=n.replace(/\/index$/,"")||"/";let o=await f.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:m,params:O,nextConfig:h,parsedUrl:C,isDraftMode:S,prerenderManifest:b,routerServerContext:D,isOnDemandRevalidate:M,revalidateOnlyGenerated:L,resolvedPathname:y,clientReferenceManifest:v,serverActionsManifest:F}=o,w=(0,c.normalizeAppPath)(n),P=!!(b.dynamicRoutes[w]||b.routes[y]),U=async()=>((null==D?void 0:D.render404)?await D.render404(e,t,C,!1):t.end("This page could not be found"),null);if(P&&!S){let e=!!b.routes[y],t=b.dynamicRoutes[w];if(t&&!1===t.fallback&&!e){if(h.experimental.adapterPath)return await U();throw new T.NoFallbackError}}let x=null;!P||f.isDev||S||(x=y,x="/index"===x?"/":x);let G=!0===f.isDev||!P,H=P&&!G;F&&v&&(0,l.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:v,serverActionsManifest:F,serverModuleMap:(0,d.createServerModuleMap)({serverActionsManifest:F})});let k=e.method||"GET",B=(0,s.getTracer)(),Y=B.getActiveScopeSpan(),q={params:O,prerenderManifest:b,renderOpts:{experimental:{authInterrupts:!!h.experimental.authInterrupts},cacheComponents:!!h.cacheComponents,supportsDynamicResponse:G,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:h.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>f.onRequestError(e,t,n,D)},sharedContext:{buildId:m}},V=new E.NodeNextRequest(e),K=new E.NodeNextResponse(t),j=u.NextRequestAdapter.fromNodeNextRequest(V,(0,u.signalFromNodeResponse)(t));try{let o=async e=>f.handle(j,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=B.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==R.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${k} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${k} ${n}`)}),l=!!(0,i.getRequestMeta)(e,"minimalMode"),d=async i=>{var s,d;let c=async({previousCacheEntry:a})=>{try{if(!l&&M&&L&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(i);e.fetchMetrics=q.renderOpts.fetchMetrics;let s=q.renderOpts.pendingWaitUntil;s&&r.waitUntil&&(r.waitUntil(s),s=void 0);let d=q.renderOpts.collectedTags;if(!P)return await (0,_.sendResponse)(V,K,n,q.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,I.toNodeOutgoingHttpHeaders)(n.headers);d&&(t[A.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=A.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,a=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=A.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await f.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:M})},D),t}},E=await f.handleResponse({req:e,nextConfig:h,cacheKey:x,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:b,isRoutePPREnabled:!1,isOnDemandRevalidate:M,revalidateOnlyGenerated:L,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:l});if(!P)return null;if((null==E||null==(s=E.value)?void 0:s.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==E||null==(d=E.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",M?"REVALIDATED":E.isMiss?"MISS":E.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,I.fromNodeOutgoingHttpHeaders)(E.value.headers);return l&&P||u.delete(A.NEXT_CACHE_TAGS_HEADER),!E.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,N.getCacheControlHeader)(E.cacheControl)),await (0,_.sendResponse)(V,K,new Response(E.value.body,{headers:u,status:E.value.status||200})),null};Y?await d(Y):await B.withPropagatedContext(e.headers,()=>B.trace(R.BaseServerSpan.handleRequest,{spanName:`${k} ${n}`,kind:s.SpanKind.SERVER,attributes:{"http.method":k,"http.target":e.url}},d))}catch(t){if(t instanceof T.NoFallbackError||await f.onRequestError(e,t,{routerKind:"App Router",routePath:w,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:M})}),P)throw t;return await (0,_.sendResponse)(V,K,new Response(null,{status:500})),null}}e.s(["handler",()=>C,"patchFetch",()=>h,"routeModule",()=>f,"serverHooks",()=>D,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>b]),r()}catch(e){r(e)}},!1),324027,e=>{e.v(e=>Promise.resolve().then(()=>e(725639)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__8706b82c._.js.map