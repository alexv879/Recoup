{
  "buildCommand": "npm run build",
  "regions": ["lhr1"],
  "framework": "nextjs",
  "functions": {
    "app/api/**/*.ts": {
      "memory": 1024,
      "maxDuration": 30
    },
    "app/api/voice/**/*.ts": {
      "memory": 1024,
      "maxDuration": 60
    },
    "app/api/dashboard/export/**/*.ts": {
      "memory": 2048,
      "maxDuration": 60
    },
    "app/api/webhooks/**/*.ts": {
      "memory": 512,
      "maxDuration": 30
    }
  },
  "env": {
    "NODE_ENV": "production"
  },
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "Access-Control-Allow-Origin",
          "value": "*"
        },
        {
          "key": "Access-Control-Allow-Methods",
          "value": "GET, POST, PUT, DELETE, OPTIONS"
        },
        {
          "key": "Access-Control-Allow-Headers",
          "value": "X-Requested-With, Content-Type, Authorization"
        }
      ]
    }
  ],
  "crons": [
    {
      "path": "/api/cron/reset-monthly-usage",
      "schedule": "0 0 1 * *"
    },
    {
      "path": "/api/cron/send-behavioral-emails",
      "schedule": "0 10 * * *"
    },
    {
      "path": "/api/cron/process-email-sequence",
      "schedule": "0 * * * *",
      "description": "Hourly check for overdue invoices and send Day 5/15/30 reminder emails"
    },
    {
      "path": "/api/cron/process-escalations",
      "schedule": "0 */6 * * *",
      "description": "Every 6 hours - Auto-escalate overdue invoices through collections stages (gentle → firm → final → agency)"
    },
    {
      "path": "/api/cron/check-verification-deadlines",
      "schedule": "0 * * * *",
      "description": "Hourly check for payment verification deadlines - Send reminders at 24h/6h marks, auto-resume collections if deadline expires"
    },
    {
      "path": "/api/cron/process-recurring-invoices",
      "schedule": "0 0 * * *",
      "description": "Daily at midnight UTC - Generate invoices from active recurring invoice schedules"
    },
    {
      "path": "/api/cron/retry-webhooks",
      "schedule": "* * * * *",
      "description": "Every minute - Retry failed webhooks with exponential backoff (max 5 retries before dead letter queue)"
    }
  ]
}
